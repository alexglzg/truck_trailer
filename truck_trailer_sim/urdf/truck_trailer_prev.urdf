<?xml version="1.0"?>
<robot name="truck_trailer">
  
  <!-- ================================================================ -->
  <!-- TRAILER - Frame at REAR AXLE (matches x1, y1) -->
  <!-- ================================================================ -->
  <link name="trailer_link">
    <visual>
      <geometry>
        <!-- Total length: 0.555m -->
        <box size="0.555 0.35 0.08"/>
      </geometry>
      <!-- Frame at rear axle, box center at 0.2275m forward -->
      <origin xyz="0.2275 0 0.115" rpy="0 0 0"/>
      <material name="red">
        <color rgba="0.9 0.1 0.1 1.0"/>
      </material>
    </visual>
  </link>
  
  <!-- Trailer wheels at rear axle (frame origin) -->
  <link name="trailer_left_wheel">
    <visual>
      <geometry>
        <cylinder radius="0.04" length="0.03"/>
      </geometry>
      <origin xyz="0 0 0" rpy="1.57 0 0"/>
      <material name="black">
        <color rgba="0.1 0.1 0.1 1.0"/>
      </material>
    </visual>
  </link>
  
  <joint name="trailer_left_wheel_joint" type="fixed">
    <parent link="trailer_link"/>
    <child link="trailer_left_wheel"/>
    <origin xyz="0 0.135 0.04" rpy="0 0 0"/>
  </joint>
  
  <link name="trailer_right_wheel">
    <visual>
      <geometry>
        <cylinder radius="0.04" length="0.03"/>
      </geometry>
      <origin xyz="0 0 0" rpy="1.57 0 0"/>
      <material name="black">
        <color rgba="0.1 0.1 0.1 1.0"/>
      </material>
    </visual>
  </link>
  
  <joint name="trailer_right_wheel_joint" type="fixed">
    <parent link="trailer_link"/>
    <child link="trailer_right_wheel"/>
    <origin xyz="0 -0.135 0.04" rpy="0 0 0"/>
  </joint>
    
  <!-- ================================================================ -->
  <!-- truck - Frame at REAR AXLE -->
  <!-- ================================================================ -->
  <link name="truck_base">
    <visual>
      <geometry>
        <!-- Total length: 0.55m -->
        <box size="0.55 0.35 0.05"/>
      </geometry>`
      <!-- Frame at rear axle, box center at 0.1755m forward -->
      <origin xyz="0.1755 0 0.05" rpy="0 0 0"/>
      <!-- <origin xyz="0.225 0 0.05" rpy="0 0 0"/> -->
      <material name="dark_blue">
        <color rgba="0.1 0.2 0.6 1.0"/>
      </material>
    </visual>
  </link>
  
  <!-- HITCH JOINT: Connects trailer to truck -->
  <joint name="hitch_joint" type="continuous">
    <parent link="trailer_link"/>
    <child link="truck_base"/>
    <origin xyz="0.495 0 0" rpy="0 0 0"/>
    <!-- <origin xyz="0.540 0 0" rpy="0 0 0"/> -->
    <axis xyz="0 0 1"/>
  </joint>
  
  <link name="truck_cube">
    <visual>
      <geometry>
        <box size="0.15 0.35 0.10"/>
      </geometry>
      <origin xyz="0 0 0.1" rpy="0 0 0"/>
      <material name="dark_blue">
        <color rgba="0.1 0.2 0.6 1.0"/>
      </material>
    </visual>
  </link>
  
  <joint name="truck_cube_joint" type="fixed">
    <parent link="truck_base"/>
    <child link="truck_cube"/>
    <origin xyz="0.35 0 0.025" rpy="0 0 0"/>
  </joint>
  
  <!-- Front wheel at L0 = 0.421m forward of rear axle -->
  <link name="front_wheel">
    <visual>
      <geometry>
        <cylinder radius="0.04" length="0.03"/>
      </geometry>
      <origin xyz="0 0 0" rpy="1.57 0 0"/>
      <material name="black">
        <color rgba="0.1 0.1 0.1 1.0"/>
      </material>
    </visual>
  </link>
  
  <joint name="front_wheel_joint" type="continuous">
    <parent link="truck_base"/>
    <child link="front_wheel"/>
    <!-- <origin xyz="0.421 0 0.04" rpy="0 0 0"/> -->
    <origin xyz="0.3715 0 0.04" rpy="0 0 0"/>
    <axis xyz="0 0 1"/>
  </joint>
  
  <!-- Rear wheels at frame origin (rear axle) -->
  <link name="rear_left_wheel">
    <visual>
      <geometry>
        <cylinder radius="0.04" length="0.03"/>
      </geometry>
      <origin xyz="0 0 0" rpy="1.57 0 0"/>
      <material name="black">
        <color rgba="0.1 0.1 0.1 1.0"/>
      </material>
    </visual>
  </link>
  
  <joint name="rear_left_wheel_joint" type="fixed">
    <parent link="truck_base"/>
    <child link="rear_left_wheel"/>
    <!-- <origin xyz="0 0.175 0.04" rpy="0 0 0"/> -->
    <origin xyz="-0.0495 0.135 0.04" rpy="0 0 0"/>
  </joint>
  
  <link name="rear_right_wheel">
    <visual>
      <geometry>
        <cylinder radius="0.04" length="0.03"/>
      </geometry>
      <origin xyz="0 0 0" rpy="1.57 0 0"/>
      <material name="black">
        <color rgba="0.1 0.1 0.1 1.0"/>
      </material>
    </visual>
  </link>
  
  <joint name="rear_right_wheel_joint" type="fixed">
    <parent link="truck_base"/>
    <child link="rear_right_wheel"/>
    <!-- <origin xyz="0 -0.175 0.04" rpy="0 0 0"/> -->
    <origin xyz="-0.0495 -0.135 0.04" rpy="0 0 0"/>
  </joint>
    
  <!-- Hitch marker at 0.045m behind rear axle -->
  <link name="hitch_marker">
    <visual>
      <geometry>
        <sphere radius="0.02"/>
      </geometry>
      <material name="yellow">
        <color rgba="1.0 1.0 0.0 1.0"/>
      </material>
    </visual>
  </link>
  
  <joint name="hitch_marker_joint" type="fixed">
    <parent link="truck_base"/>
    <child link="hitch_marker"/>
    <origin xyz="0.0 0 0.04" rpy="0 0 0"/>
  </joint>
  
</robot>